<!-- The third page -> Displays the final allocation result returned by the algorithm -->

{% extends "layout.html" %}
{% block content %}

  <!-- Button to open the window "show logs" -->
  <button
    type="button"
    class="btn btn-primary mb-3"
    data-bs-toggle="modal"
    data-bs-target="#logsModal"
  >
    Show Logs
  </button>

  <!-- Styled final allocation header matching valuations page -->
  <div id="finalAllocationMessage" class="text-center mb-4" style="color:#FF0000; font-family:'Pacifico', cursive; font-size:1.5rem; font-weight:normal;">
    Final Allocation
  </div>

  <!-- flex container: left=list, right=buttons -->
  <div class="d-flex justify-content-center align-items-start">
    <!-- Left: רשימת השחקנים והמתנות -->
    <ul class="list-group">
      {% for player, gifts in allocation.items() %}
        <li class="list-group-item">
          {{ player }} → {{ gifts|join(", ") }}
        </li>
      {% endfor %}
    </ul>

    <!-- Right: העמודת כפתורי הסכום -->
    <div class="ms-4">
      {% for player in allocation.keys() %}
        <button
          type="button"
          class="explanation-text btn btn-sm mb-2"
          style="
            font-size: 1rem;                           /* גודל כמו P1 */
            background-color: #fff;                    /* רקע לבן כמו list-group-item */
            border: 1px solid rgba(0,0,0,0.125);       /* גבול כמו list-group-item */
          "
          onclick="alert('Total value for {{ player }}: {{ sum_values[player] }}');"
        >
          Sum of Values for {{ player }}
        </button>
      {% endfor %}
    </div>
  </div>

  <a href="{{ url_for('setup') }}" class="btn btn-link mt-3">Start Over</a>

  <!-- Logs Modal -->
  <div class="modal fade" id="logsModal" tabindex="-1" aria-labelledby="logsModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg modal-dialog-scrollable">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="logsModalLabel">Algorithm Logs</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body" style="max-height:60vh; overflow-y:auto;">
          <pre style="white-space: pre-wrap;">{{ logs|join('\n') }}</pre>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
        </div>
      </div>
    </div>
  </div>


{% endblock %}
