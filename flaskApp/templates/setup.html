<!-- The initial page with fields for num_players and num_items -->

{% extends "layout.html" %}
{% block body_class %}home{% endblock %}
{% block content %}

<!-- The article & about me -->
  <div class="top-actions mb-3">
    <div class="left">
      <button type="button" class="back-btn" data-bs-toggle="modal" data-bs-target="#aboutModal">
        About Me
      </button>
    </div>

    <div></div>

    <div class="right">
      <a href="{{ url_for('static', filename='Santa Claus Meets Hypergraph Matchings.pdf') }}" class="back-btn" target="_blank">
        The Article
      </a>
    </div>
  </div>


  <div class="container mx-auto" style="max-width:900px;">

  <!-- Algorithm explanation -->
  <div id="algorithmExplanationMessage" class="explanation-text text-start mb-4">
    This algorithm is designed to maximize the minimum value each participant receives, ensuring as fair a distribution of Santa’s gifts as possible.
    The solution uses a bipartite hypergraph to find a perfect matching that respects the valuations.</br>
    To run the algorithm, enter the number of players and gifts and click “Next.”
  </div>

  <!-- Error message when players > items -->
  <div id="constraintErrorMessage" class="text-danger mb-3" style="display: none;">
    Cannot enter more players than items.
  </div>
  <div class="d-flex align-items-center">
    <!-- Form on the left -->
    <div class="flex-grow-1 pe-3">
      <form method="POST" action="{{ url_for('setup') }}">
        <div class="mb-3">
          <label for="num_players" class="form-label">Number of Players</label>
          <input
            type="number"
            class="form-control form-control-lg"
            id="num_players"
            name="num_players"
            min="1"
            max="10"
            required>
        </div>
        <div class="mb-3">
          <label for="num_items" class="form-label">Number of Gifts</label>
          <input
            type="number"
            class="form-control form-control-lg"
            id="num_items"
            name="num_items"
            min="1"
            max="10"
            required>
        </div>
        <button id="nextBtn" type="submit" class="gift-btn action-btn" disabled>
          <span>NEXT</span>
          <img src="{{ url_for('static', filename='images/gifts.png') }}" alt="gifts">
        </button>
      </form>
    </div>
    <!-- Santa Claus and gifts image on the right -->
    <div class="flex-shrink-0">
      <img
        src="{{ url_for('static', filename='images/santa_gifts.png') }}"
        alt="Santa Claus and Gifts"
        class="img-fluid"
        style="max-height: 300px;">
    </div>
  </div>

    <!-- About Me Modal -->
  <div class="modal fade" id="aboutModal"
     data-bs-backdrop="false"
     data-bs-scroll="true"
     tabindex="-1" aria-labelledby="aboutModalLabel" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content text-dark">
        <div class="modal-header">
          <h5 class="modal-title" id="aboutModalLabel">About Me</h5>
          <button
            type="button"
            class="btn-close"
            data-bs-dismiss="modal"
            aria-label="Close"
          ></button>
        </div>
        <div class="modal-body text-start">
          <p>
            Hi, I’m <strong>May Rozen</strong>, a B.Sc. graduate in Computer Science <br class="br-desktop">from Ariel University.<br class="br-desktop"><br class="br-mobile">
            I built this project as part of my “Research Algorithms” course, where we select an algorithm from a research paper and implement it
            <br class="br-desktop">end-to-end — including performance optimizations and
            <br class="br-desktop">a <br class="br-mobile">server-based web demo.<br class="br-desktop"><br class="br-mobile">
            Recently, I’ve been focusing more on frontend development, <br class="br-desktop">so I refreshed the design and improved the overall usability
            <br class="br-desktop">and performance.<br class="br-desktop"><br class="br-mobile">
            The algorithm is also available as a Python package (installable via pip); installation and usage instructions are provided in the project <br class="br-mobile">README below.
          </p>

          <br>

          <h6><strong>Want more info? Here some links!</strong></h6>
          <div class="about-links">
            <a href="https://github.com/MayRozen/App-Research-Algorithms#readme" target="_blank" rel="noopener" title="Project README">
              <img src="{{ url_for('static', filename='images/icons/info_logo.png') }}" alt="Project README">
              <div class="about-caption">README</div>
            </a>

            <a href="https://github.com/MayRozen" target="_blank" rel="noopener" title="GitHub">
              <img src="{{ url_for('static', filename='images/icons/github_logo.png') }}" alt="GitHub">
              <div class="about-caption">GitHub</div>
            </a>

            <a href="https://www.linkedin.com/in/may-rozen-4b07bb324?" target="_blank" rel="noopener" title="LinkedIn">
              <img src="{{ url_for('static', filename='images/icons/linkedin_logo.webp') }}" alt="LinkedIn">
              <div class="about-caption">LinkedIn</div>
            </a>

            <a href="mailto:mayrozen45@gmail.com" title="Email">
              <img src="{{ url_for('static', filename='images/icons/mail_logo.webp') }}" alt="Email">
              <div class="about-caption">Email</div>
            </a>
          </div>
        </div>
        <div class="modal-footer">
          <button
            type="button"
            class="btn btn-secondary"
            data-bs-dismiss="modal"
          >
            Close
          </button>
        </div>
      </div>
    </div>
  </div>
</div>

  <!-- Client-side validation script -->
  <script>
  document.addEventListener('DOMContentLoaded', () => {
    const playersInput = document.getElementById('num_players');
    const itemsInput   = document.getElementById('num_items');
    const nextBtn      = document.getElementById('nextBtn');
    const errorDiv     = document.getElementById('constraintErrorMessage');

    function validate() {
      const numPlayers = parseInt(playersInput.value) || 0;
      const numItems   = parseInt(itemsInput.value) || 0;

      // Check if values are valid
      const valid = (numPlayers >= 1 && numItems >= 1 && numPlayers <= numItems);

      if (valid) {
        nextBtn.disabled = false;
        errorDiv.style.display = 'none';
        playersInput.classList.remove('is-invalid');
        itemsInput.classList.remove('is-invalid');
      } else {
        nextBtn.disabled = true;
        errorDiv.style.display = (numPlayers > numItems ? 'block' : 'none');
        playersInput.classList.add('is-invalid');
        itemsInput.classList.add('is-invalid');
      }
    }

    playersInput.addEventListener('input', validate);
    itemsInput.addEventListener('input', validate);

    // Initial validation
    validate();
  });
  </script>

{% endblock %}